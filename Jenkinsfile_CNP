#!groovy
//noinspection GroovyUnusedAssignment
@Library("Infrastructure") _

import uk.gov.hmcts.contino.Environment

Environment environment = new Environment(env)

slackChannel = "#ccd-master-builds"

onMaster {
    try {
        sharedInfrastructurePipeline('ccd', environment.nonProdName, 'nonprod')
        sharedInfrastructurePipeline('ccd', environment.prodName, 'prod')
        notifyBuildFixed channel: slackChannel
    } catch (err) {
        notifyBuildFailure channel: slackChannel
        throw err
    }
}

onDemo {
    try {
        sharedInfrastructurePipeline('ccd', environment.demoName, 'nonprod')
        notifyBuildFixed channel: slackChannel
    } catch (err) {
        notifyBuildFailure channel: slackChannel
        throw err
    }
}
